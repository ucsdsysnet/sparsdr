# auto-generated by grc.converter

id: variable_sparsdr_simple_combined_pluto_receiver
label: Simple Combined Pluto Receiver
category: '[SparSDR]'
# Dummy value is required so GNU Radio Companion will generate code
value: ${0}

parameters:
-   id: uri
    label: IIO context URI
    dtype: string
    default: ip:192.168.2.1
-   id: frequency
    label: Center frequency
    dtype: int
    default: '2412000000'
-   id: gain
    label: Gain
    dtype: float
    default: '60'
    hide: ${ 'none' if (gain_control_mode == 'manual') else 'all' }
-   id: gain_control_mode
    label: Gain control mode
    dtype: string
    default: manual
    options: [manual, fast_attack, slow_attack, hybrid]
    option_labels: [manual, fast_attack, slow_attack, hybrid]
-   id: buffer_size
    label: Buffer size (samples)
    dtype: int
    default: 1024 * 1024
-   id: shift_amount
    label: Shift amount
    dtype: int
    default: '6'
-   id: threshold
    label: Threshold
    dtype: int
    default: '1000'
-   id: reconstruct_path
    label: Executable
    category: Reconstruct
    dtype: string
    default: sparsdr_reconstruct
-   id: zero_gaps
    label: Zero samples in gaps
    category: Reconstruct
    dtype: enum
    default: 'False'
    options: ['True', 'False']
-   id: band_count
    label: Number of bands
    category: Bands
    dtype: int
    default: '1'
    hide: part
-   id: band_0_frequency
    label: Band 0 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 0 else 'all') }
-   id: band_0_bandwidth
    label: Band 0 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 0 else 'all') }
-   id: band_1_frequency
    label: Band 1 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 1 else 'all') }
-   id: band_1_bandwidth
    label: Band 1 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 1 else 'all') }
-   id: band_2_frequency
    label: Band 2 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 2 else 'all') }
-   id: band_2_bandwidth
    label: Band 2 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 2 else 'all') }
-   id: band_3_frequency
    label: Band 3 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 3 else 'all') }
-   id: band_3_bandwidth
    label: Band 3 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 3 else 'all') }
-   id: band_4_frequency
    label: Band 4 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 4 else 'all') }
-   id: band_4_bandwidth
    label: Band 4 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 4 else 'all') }
-   id: band_5_frequency
    label: Band 5 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 5 else 'all') }
-   id: band_5_bandwidth
    label: Band 5 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 5 else 'all') }
-   id: band_6_frequency
    label: Band 6 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 6 else 'all') }
-   id: band_6_bandwidth
    label: Band 6 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 6 else 'all') }
-   id: band_7_frequency
    label: Band 7 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 7 else 'all') }
-   id: band_7_bandwidth
    label: Band 7 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 7 else 'all') }
-   id: band_8_frequency
    label: Band 8 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 8 else 'all') }
-   id: band_8_bandwidth
    label: Band 8 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 8 else 'all') }
-   id: band_9_frequency
    label: Band 9 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 9 else 'all') }
-   id: band_9_bandwidth
    label: Band 9 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 9 else 'all') }
-   id: band_10_frequency
    label: Band 10 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 10 else 'all') }
-   id: band_10_bandwidth
    label: Band 10 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 10 else 'all') }
-   id: band_11_frequency
    label: Band 11 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 11 else 'all') }
-   id: band_11_bandwidth
    label: Band 11 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 11 else 'all') }
-   id: band_12_frequency
    label: Band 12 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 12 else 'all') }
-   id: band_12_bandwidth
    label: Band 12 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 12 else 'all') }
-   id: band_13_frequency
    label: Band 13 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 13 else 'all') }
-   id: band_13_bandwidth
    label: Band 13 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 13 else 'all') }
-   id: band_14_frequency
    label: Band 14 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 14 else 'all') }
-   id: band_14_bandwidth
    label: Band 14 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 14 else 'all') }
-   id: band_15_frequency
    label: Band 15 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 15 else 'all') }
-   id: band_15_bandwidth
    label: Band 15 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 15 else 'all') }
-   id: band_16_frequency
    label: Band 16 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 16 else 'all') }
-   id: band_16_bandwidth
    label: Band 16 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 16 else 'all') }
-   id: band_17_frequency
    label: Band 17 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 17 else 'all') }
-   id: band_17_bandwidth
    label: Band 17 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 17 else 'all') }
-   id: band_18_frequency
    label: Band 18 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 18 else 'all') }
-   id: band_18_bandwidth
    label: Band 18 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 18 else 'all') }
-   id: band_19_frequency
    label: Band 19 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 19 else 'all') }
-   id: band_19_bandwidth
    label: Band 19 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 19 else 'all') }
-   id: band_20_frequency
    label: Band 20 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 20 else 'all') }
-   id: band_20_bandwidth
    label: Band 20 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 20 else 'all') }
-   id: band_21_frequency
    label: Band 21 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 21 else 'all') }
-   id: band_21_bandwidth
    label: Band 21 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 21 else 'all') }
-   id: band_22_frequency
    label: Band 22 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 22 else 'all') }
-   id: band_22_bandwidth
    label: Band 22 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 22 else 'all') }
-   id: band_23_frequency
    label: Band 23 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 23 else 'all') }
-   id: band_23_bandwidth
    label: Band 23 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 23 else 'all') }
-   id: band_24_frequency
    label: Band 24 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 24 else 'all') }
-   id: band_24_bandwidth
    label: Band 24 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 24 else 'all') }
-   id: band_25_frequency
    label: Band 25 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 25 else 'all') }
-   id: band_25_bandwidth
    label: Band 25 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 25 else 'all') }
-   id: band_26_frequency
    label: Band 26 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 26 else 'all') }
-   id: band_26_bandwidth
    label: Band 26 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 26 else 'all') }
-   id: band_27_frequency
    label: Band 27 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 27 else 'all') }
-   id: band_27_bandwidth
    label: Band 27 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 27 else 'all') }
-   id: band_28_frequency
    label: Band 28 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 28 else 'all') }
-   id: band_28_bandwidth
    label: Band 28 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 28 else 'all') }
-   id: band_29_frequency
    label: Band 29 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 29 else 'all') }
-   id: band_29_bandwidth
    label: Band 29 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 29 else 'all') }
-   id: band_30_frequency
    label: Band 30 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 30 else 'all') }
-   id: band_30_bandwidth
    label: Band 30 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 30 else 'all') }
-   id: band_31_frequency
    label: Band 31 frequency
    category: Bands
    dtype: real
    default: 2.426e9
    hide: ${ ('none' if int(band_count) > 31 else 'all') }
-   id: band_31_bandwidth
    label: Band 31 bandwidth
    category: Bands
    dtype: real
    default: 2e6
    hide: ${ ('none' if int(band_count) > 31 else 'all') }

-   id: skip_config
    label: Skip bin configuration
    hide: part
    dtype: bool
    default: 'False'
    options: ['False', 'True']
    option_labels: ['False', 'True']

outputs:
-   domain: stream
    dtype: complex
    multiplicity: ${ band_count }
asserts:
- ${ 32 >= band_count }
- ${ band_count > 0 }

templates:
    imports: |-
        import sparsdr
        import distutils.spawn
    var_make: |-
        ${id}_bands = sparsdr.simple_band_spec_vector()
        % if int(eval(band_count)) > 0:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_0_frequency}, ${band_0_bandwidth})
        % endif
        % if int(eval(band_count)) > 1:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_1_frequency}, ${band_1_bandwidth})
        % endif
        % if int(eval(band_count)) > 2:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_2_frequency}, ${band_2_bandwidth})
        % endif
        % if int(eval(band_count)) > 3:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_3_frequency}, ${band_3_bandwidth})
        % endif
        % if int(eval(band_count)) > 4:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_4_frequency}, ${band_4_bandwidth})
        % endif
        % if int(eval(band_count)) > 5:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_5_frequency}, ${band_5_bandwidth})
        % endif
        % if int(eval(band_count)) > 6:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_6_frequency}, ${band_6_bandwidth})
        % endif
        % if int(eval(band_count)) > 7:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_7_frequency}, ${band_7_bandwidth})
        % endif
        % if int(eval(band_count)) > 8:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_8_frequency}, ${band_8_bandwidth})
        % endif
        % if int(eval(band_count)) > 9:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_9_frequency}, ${band_9_bandwidth})
        % endif
        % if int(eval(band_count)) > 10:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_10_frequency}, ${band_10_bandwidth})
        % endif
        % if int(eval(band_count)) > 11:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_11_frequency}, ${band_11_bandwidth})
        % endif
        % if int(eval(band_count)) > 12:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_12_frequency}, ${band_12_bandwidth})
        % endif
        % if int(eval(band_count)) > 13:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_13_frequency}, ${band_13_bandwidth})
        % endif
        % if int(eval(band_count)) > 14:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_14_frequency}, ${band_14_bandwidth})
        % endif
        % if int(eval(band_count)) > 15:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_15_frequency}, ${band_15_bandwidth})
        % endif
        % if int(eval(band_count)) > 16:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_16_frequency}, ${band_16_bandwidth})
        % endif
        % if int(eval(band_count)) > 17:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_17_frequency}, ${band_17_bandwidth})
        % endif
        % if int(eval(band_count)) > 18:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_18_frequency}, ${band_18_bandwidth})
        % endif
        % if int(eval(band_count)) > 19:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_19_frequency}, ${band_19_bandwidth})
        % endif
        % if int(eval(band_count)) > 20:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_20_frequency}, ${band_20_bandwidth})
        % endif
        % if int(eval(band_count)) > 21:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_21_frequency}, ${band_21_bandwidth})
        % endif
        % if int(eval(band_count)) > 22:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_22_frequency}, ${band_22_bandwidth})
        % endif
        % if int(eval(band_count)) > 23:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_23_frequency}, ${band_23_bandwidth})
        % endif
        % if int(eval(band_count)) > 24:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_24_frequency}, ${band_24_bandwidth})
        % endif
        % if int(eval(band_count)) > 25:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_25_frequency}, ${band_25_bandwidth})
        % endif
        % if int(eval(band_count)) > 26:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_26_frequency}, ${band_26_bandwidth})
        % endif
        % if int(eval(band_count)) > 27:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_27_frequency}, ${band_27_bandwidth})
        % endif
        % if int(eval(band_count)) > 28:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_28_frequency}, ${band_28_bandwidth})
        % endif
        % if int(eval(band_count)) > 29:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_29_frequency}, ${band_29_bandwidth})
        % endif
        % if int(eval(band_count)) > 30:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_30_frequency}, ${band_30_bandwidth})
        % endif
        % if int(eval(band_count)) > 31:
        ${id}_bands.push_back(sparsdr.simple_band_spec(${band_31_frequency}, ${band_31_bandwidth})
        % endif
        self.${id} = ${id} = sparsdr.simple_combined_pluto_receiver(uri=${uri}, buffer_size=${buffer_size}, center_frequency=${frequency}, bands=${id}_bands, threshold=${threshold}, reconstruct_path=distutils.spawn.find_executable(${reconstruct_path}), zero_gaps=${zero_gaps}, skip_bin_config=${skip_config})
        self.${id}.set_gain_control_mode(${gain_control_mode})
        % if eval(gain_control_mode) == "manual":
        self.${id}.set_gain(${gain})
        % endif
        self.${id}.set_shift_amount(${shift_amount})

file_format: 1
